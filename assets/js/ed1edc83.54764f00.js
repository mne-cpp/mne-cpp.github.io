"use strict";(globalThis.webpackChunkmne_cpp_website=globalThis.webpackChunkmne_cpp_website||[]).push([[4662],{68634(e,n,i){i.r(n),i.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>a,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"manual/workflow","title":"The Typical MEG/EEG Workflow","description":"Overview","source":"@site/docs/manual/workflow.mdx","sourceDirName":"manual","slug":"/manual/workflow","permalink":"/docs/manual/workflow","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"title":"The Typical MEG/EEG Workflow","sidebar_label":"Workflow","sidebar_position":2},"sidebar":"docsSidebar","previous":{"title":"Introduction","permalink":"/docs/manual/intro"},"next":{"title":"Forward Solution","permalink":"/docs/manual/forward"}}');var t=i(74848),r=i(28453);const a={title:"The Typical MEG/EEG Workflow",sidebar_label:"Workflow",sidebar_position:2},o="The Typical MEG/EEG Workflow",l={},c=[{value:"Overview",id:"overview",level:2},{value:"Processing Stages at a Glance",id:"processing-stages-at-a-glance",level:3},{value:"Setting Up the Analysis Environment",id:"setting-up-the-analysis-environment",level:2},{value:"Preprocessing",id:"preprocessing",level:2},{value:"Marking Bad Channels",id:"marking-bad-channels",level:3},{value:"Artifact Suppression",id:"artifact-suppression",level:3},{value:"Signal-Space Projection (SSP)",id:"signal-space-projection-ssp",level:4},{value:"Independent Component Analysis (ICA)",id:"independent-component-analysis-ica",level:4},{value:"Downsampling",id:"downsampling",level:3},{value:"Epoching and Evoked Data",id:"epoching-and-evoked-data",level:2},{value:"Rejection Using Annotations",id:"rejection-using-annotations",level:3},{value:"Source Localization",id:"source-localization",level:2},{value:"Anatomical Information",id:"anatomical-information",level:3},{value:"Cortical Surface Reconstruction with FreeSurfer",id:"cortical-surface-reconstruction-with-freesurfer",level:4},{value:"Setting Up the Source Space",id:"setting-up-the-source-space",level:4},{value:"Creating the BEM Model Meshes",id:"creating-the-bem-model-meshes",level:3},{value:"Head Surface Triangulation Files",id:"head-surface-triangulation-files",level:4},{value:"Setting Up the BEM",id:"setting-up-the-bem",level:3},{value:"Aligning Coordinate Frames",id:"aligning-coordinate-frames",level:3},{value:"Computing the Forward Solution",id:"computing-the-forward-solution",level:3},{value:"Computing the Noise-Covariance Matrix",id:"computing-the-noise-covariance-matrix",level:3},{value:"Calculating the Inverse Operator",id:"calculating-the-inverse-operator",level:3},{value:"Creating Source Estimates",id:"creating-source-estimates",level:3},{value:"Group Analyses",id:"group-analyses",level:3},{value:"References",id:"references",level:2}];function d(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",mermaid:"mermaid",ol:"ol",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"the-typical-megeeg-workflow",children:"The Typical MEG/EEG Workflow"})}),"\n",(0,t.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,t.jsx)(n.p,{children:"This section describes the typical MEG/EEG workflow \u2014 from raw data preprocessing through to source reconstruction \u2014 as originally outlined in the MNE-C manual cookbook (H\xe4m\xe4l\xe4inen, 2009). The workflow applies to both MNE-CPP command-line tools and the GUI applications."}),"\n",(0,t.jsx)(n.p,{children:"The following diagram shows the complete workflow of the MNE software. The MRI processing path (left) and the MEG/EEG data path (right) converge at the forward solution computation."}),"\n",(0,t.jsx)(n.mermaid,{value:'flowchart TD\n    subgraph MRI_PATH["MRI Processing"]\n        direction TB\n        MRI_RAW["<b>MRI Data</b><br/><i style=\'font-weight:300\'>Raw anatomical</i>"]\n        FS["<b>Reconstructed MRI</b><br/><i style=\'font-weight:300\'>FreeSurfer</i>"]\n        COR_T1["<b>COR.fif</b> (T1)<br/><i style=\'font-weight:300\'>mne_setup_mri</i>"]\n        COR_BRAIN["<b>COR.fif</b> (brain)<br/><i style=\'font-weight:300\'>mne_setup_mri</i>"]\n        SRC["<b>Source Space</b><br/><i style=\'font-weight:300\'>mne_setup_source_space</i>"]\n        COR_ALIGNED["<b>COR-aligned.fif</b><br/><i style=\'font-weight:300\'>Coregistration</i>"]\n        BEM_MESH["<b>BEM Mesh</b><br/><i style=\'font-weight:300\'>mne_watershed_bem</i><br/><i style=\'font-weight:300\'>mne_flash_bem</i>"]\n        BEM_MODEL["<b>BEM Model</b><br/><i style=\'font-weight:300\'>mne_setup_forward_model</i>"]\n\n        MRI_RAW --\x3e FS\n        FS --\x3e COR_T1\n        FS --\x3e COR_BRAIN\n        FS --\x3e SRC\n        COR_T1 --\x3e COR_ALIGNED\n        COR_BRAIN --\x3e BEM_MESH\n        BEM_MESH --\x3e BEM_MODEL\n    end\n\n    subgraph MEG_PATH["MEG/EEG Processing"]\n        direction TB\n        MEG_RAW["<b>MEG/EEG Data</b><br/><i style=\'font-weight:300\'>Raw recordings</i>"]\n        FILTERED["<b>Filtered &amp; Averaged</b><br/><i style=\'font-weight:300\'>mne_process_raw</i>"]\n        NOISE["<b>Noise Covariance</b><br/><i style=\'font-weight:300\'>mne_process_raw</i>"]\n\n        MEG_RAW --\x3e FILTERED\n        MEG_RAW --\x3e NOISE\n    end\n\n    FWD["<b>Forward Solution</b><br/><i style=\'font-weight:300\'>mne_forward_solution</i>"]\n    INV["<b>Inverse Operator</b><br/><i style=\'font-weight:300\'>mne_inverse_operator</i>"]\n    ANALYZE["<b>Analyze &amp; Visualize</b><br/><i style=\'font-weight:300\'>MNE Analyze</i>"]\n    OUTPUT["<b>Source Estimates</b><br/><i style=\'font-weight:300\'>stc / w files, movies</i>"]\n\n    SRC --\x3e FWD\n    BEM_MODEL --\x3e FWD\n    COR_ALIGNED --\x3e FWD\n    FILTERED --\x3e FWD\n    NOISE --\x3e INV\n\n    FWD --\x3e INV\n    INV --\x3e ANALYZE\n    FILTERED --\x3e ANALYZE\n    ANALYZE --\x3e OUTPUT\n\n    classDef mri fill:#d4edda,stroke:#28a745,stroke-width:2px,color:#155724,rx:8,ry:8\n    classDef meg fill:#cce5ff,stroke:#2874a6,stroke-width:2px,color:#0c3c60,rx:8,ry:8\n    classDef proc fill:#fff3cd,stroke:#d4a017,stroke-width:2px,color:#6b5900,rx:8,ry:8\n    classDef out fill:#f8d7da,stroke:#c0392b,stroke-width:2px,color:#721c24,rx:8,ry:8\n\n    class MRI_RAW,FS,COR_T1,COR_BRAIN,COR_ALIGNED,BEM_MESH,BEM_MODEL,SRC mri\n    class MEG_RAW,FILTERED,NOISE meg\n    class FWD,INV,ANALYZE proc\n    class OUTPUT out\n\n    style MRI_PATH fill:none,stroke:#28a745,stroke-width:1px,stroke-dasharray:5 5\n    style MEG_PATH fill:none,stroke:#2874a6,stroke-width:1px,stroke-dasharray:5 5\n\n    linkStyle default stroke:#6c757d,stroke-width:1.5px'}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.em,{children:"Figure: Workflow of the MNE software, adapted from the MNE-C manual (H\xe4m\xe4l\xe4inen, 2009). The MRI processing stages (green) are independent of the MEG/EEG data (blue) until the forward solution computation (yellow)."})}),"\n",(0,t.jsx)(n.h3,{id:"processing-stages-at-a-glance",children:"Processing Stages at a Glance"}),"\n",(0,t.jsx)(n.p,{children:"The main processing stages are:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Setting up the analysis environment"})," \u2014 Configure ",(0,t.jsx)(n.code,{children:"SUBJECTS_DIR"}),", FreeSurfer paths, and the analysis directory structure."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Anatomical processing"})," \u2014 FreeSurfer reconstruction, source space creation, BEM mesh generation."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Preprocessing"})," \u2014 Bad channel marking, filtering, downsampling, artifact suppression (SSP/ICA)."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Epoching and averaging"})," \u2014 Creating evoked responses from event-related data."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Forward modeling"})," \u2014 Coordinate frame alignment, BEM model setup, forward solution computation."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Inverse estimation"})," \u2014 Noise-covariance estimation, inverse operator construction."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Source analysis"})," \u2014 Applying the inverse operator, visualization, morphing, group analysis."]}),"\n"]}),"\n",(0,t.jsx)(n.admonition,{type:"tip",children:(0,t.jsx)(n.p,{children:"Steps 1\u20132 depend only on anatomical (geometrical) information and remain identical across different MEG/EEG studies on the same subject. Once the FreeSurfer reconstruction and BEM setup are complete, they can be reused for all experiments with that subject."})}),"\n",(0,t.jsx)(n.h2,{id:"setting-up-the-analysis-environment",children:"Setting Up the Analysis Environment"}),"\n",(0,t.jsx)(n.p,{children:"Before starting the data analysis:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsxs)(n.strong,{children:["Set ",(0,t.jsx)(n.code,{children:"SUBJECTS_DIR"})]})," \u2014 Set the environment variable ",(0,t.jsx)(n.code,{children:"SUBJECTS_DIR"})," to the directory containing the anatomical MRI data (FreeSurfer subject directories). Optionally, set ",(0,t.jsx)(n.code,{children:"SUBJECT"})," to the name of the current subject's MRI directory under ",(0,t.jsx)(n.code,{children:"SUBJECTS_DIR"}),". With this setting you can avoid entering the ",(0,t.jsx)(n.code,{children:"--subject"})," option common to many MNE programs and scripts."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Set up FreeSurfer"})," \u2014 Ensure the FreeSurfer environment is configured before using MNE software. The FreeSurfer and MNE software are complementary tools."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Create an analysis directory"})," \u2014 It is recommended to create a new directory for the MEG/EEG data processing. Raw data files should be linked (using ",(0,t.jsx)(n.code,{children:"ln -s"}),") rather than copied. On-line averages can be either copied or linked."]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.admonition,{type:"note",children:(0,t.jsxs)(n.p,{children:["In the following sections, files in the FreeSurfer directory hierarchy are usually referred to without specifying the leading directories. Thus, ",(0,t.jsx)(n.code,{children:"bem/subject-src.fif"})," refers to ",(0,t.jsx)(n.code,{children:"$SUBJECTS_DIR/$SUBJECT/bem/subject-src.fif"}),"."]})}),"\n",(0,t.jsx)(n.h2,{id:"preprocessing",children:"Preprocessing"}),"\n",(0,t.jsx)(n.p,{children:"The following MEG and EEG data preprocessing steps are recommended:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Bad channels in the MEG and EEG data must be identified and marked."}),"\n",(0,t.jsx)(n.li,{children:"The data has to be filtered to the desired passband."}),"\n",(0,t.jsx)(n.li,{children:"Artifacts should be suppressed (e.g., using SSP or ICA)."}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"marking-bad-channels",children:"Marking Bad Channels"}),"\n",(0,t.jsx)(n.p,{children:"Sometimes some MEG or EEG channels are not functioning properly for various reasons. These channels should be excluded from analysis by marking them as bad."}),"\n",(0,t.jsx)(n.p,{children:"It is especially important to exclude flat channels (channels that do not show a signal at all) from the analysis, since their noise estimate will be unrealistically low and thus the current estimate calculations will give a strong weight to the zero signal on the flat channels, causing the estimates to essentially vanish. It is also important to exclude noisy channels because they can affect others when signal-space projections or EEG average electrode reference is employed. Noisy bad channels can also adversely affect averaging and noise-covariance matrix estimation by causing unnecessary rejections of epochs."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Recommended ways to identify bad channels:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Observe the quality of data during data acquisition and make notes of observed malfunctioning channels to your measurement protocol sheet."}),"\n",(0,t.jsx)(n.li,{children:"View the on-line averages and check the condition of the channels."}),"\n",(0,t.jsx)(n.li,{children:"Compute preliminary off-line averages with artifact rejection, SSP/ICA, and EEG average electrode reference computation off and check the condition of the channels."}),"\n",(0,t.jsx)(n.li,{children:"View raw data and identify bad channels visually."}),"\n"]}),"\n",(0,t.jsx)(n.admonition,{type:"tip",children:(0,t.jsx)(n.p,{children:"It is strongly recommended that bad channels are identified and marked in the original raw data files. If present in the raw data files, the bad channel selections will be automatically transferred to averaged files, noise-covariance matrices, forward solution files, and inverse operator decompositions."})}),"\n",(0,t.jsx)(n.h3,{id:"artifact-suppression",children:"Artifact Suppression"}),"\n",(0,t.jsx)(n.h4,{id:"signal-space-projection-ssp",children:"Signal-Space Projection (SSP)"}),"\n",(0,t.jsx)(n.p,{children:"The Signal-Space Projection (SSP) is one approach to rejection of external disturbances in software. Unlike many other noise-cancellation approaches, SSP does not require additional reference sensors to record the disturbance fields. Instead, SSP relies on the fact that the magnetic field distributions generated by the sources in the brain have spatial distributions sufficiently different from those generated by external noise sources. Furthermore, it is implicitly assumed that the linear space spanned by the significant external noise patterns has a low dimension."}),"\n",(0,t.jsxs)(n.p,{children:["For a detailed mathematical description of the SSP method, see ",(0,t.jsx)(n.a,{href:"ssp",children:"Signal-Space Projection"}),"."]}),"\n",(0,t.jsx)(n.h4,{id:"independent-component-analysis-ica",children:"Independent Component Analysis (ICA)"}),"\n",(0,t.jsx)(n.p,{children:"Many MEG/EEG signals including biological artifacts reflect non-Gaussian processes. Therefore, PCA-based artifact rejection may perform worse at separating the signal from noise sources. ICA-based approaches provide an alternative method for separating neural activity from artifacts such as eye blinks, cardiac activity, and muscle artifacts."}),"\n",(0,t.jsx)(n.h3,{id:"downsampling",children:"Downsampling"}),"\n",(0,t.jsxs)(n.p,{children:["The minimum practical sampling frequency of the Vectorview system is 600 Hz. Lower sampling frequencies are allowed but result in elevated noise levels in the data. It is advisable to lowpass filter and downsample large raw data files \u2014 common in cognitive and patient studies \u2014 to speed up subsequent processing. This can be accomplished with ",(0,t.jsx)(n.a,{href:"tools-process-raw",children:(0,t.jsx)(n.code,{children:"mne_process_raw"})}),"."]}),"\n",(0,t.jsxs)(n.p,{children:["It is recommended that the original raw file is called ",(0,t.jsx)(n.code,{children:"<name>_raw.fif"})," and the downsampled version ",(0,t.jsx)(n.code,{children:"<name>_ds_raw.fif"}),"."]}),"\n",(0,t.jsx)(n.h2,{id:"epoching-and-evoked-data",children:"Epoching and Evoked Data"}),"\n",(0,t.jsxs)(n.p,{children:["Epoching of raw data is done using events, which define a ",(0,t.jsx)(n.code,{children:"t=0"})," for data segments. Event times stamped to the acquisition software can be extracted from the raw data file. The events array can then be modified, extended, or changed if necessary."]}),"\n",(0,t.jsx)(n.p,{children:"Once epochs are constructed with appropriate rejection thresholds, they can be averaged to obtain evoked response data."}),"\n",(0,t.jsx)(n.admonition,{type:"note",children:(0,t.jsx)(n.p,{children:"The rejection thresholds are defined in T/m for gradiometers, T for magnetometers, and V for EEG and EOG channels."})}),"\n",(0,t.jsx)(n.h3,{id:"rejection-using-annotations",children:"Rejection Using Annotations"}),"\n",(0,t.jsx)(n.p,{children:"Bad segments of data can also be rejected by marking segments of raw data with annotations, providing an alternative to peak-to-peak threshold-based rejection."}),"\n",(0,t.jsx)(n.h2,{id:"source-localization",children:"Source Localization"}),"\n",(0,t.jsxs)(n.p,{children:["MNE makes extensive use of the FreeSurfer file structure for analysis. Before starting data analysis, set up the environment variable ",(0,t.jsx)(n.code,{children:"SUBJECTS_DIR"})," to select the directory under which the anatomical MRI data are stored."]}),"\n",(0,t.jsx)(n.h3,{id:"anatomical-information",children:"Anatomical Information"}),"\n",(0,t.jsx)(n.h4,{id:"cortical-surface-reconstruction-with-freesurfer",children:"Cortical Surface Reconstruction with FreeSurfer"}),"\n",(0,t.jsxs)(n.p,{children:["The first processing stage is the creation of various surface reconstructions with FreeSurfer. The recommended FreeSurfer workflow is summarized on the ",(0,t.jsx)(n.a,{href:"https://surfer.nmr.mgh.harvard.edu/fswiki/RecommendedReconstruction",children:"FreeSurfer wiki"}),"."]}),"\n",(0,t.jsx)(n.h4,{id:"setting-up-the-source-space",children:"Setting Up the Source Space"}),"\n",(0,t.jsx)(n.p,{children:"This stage consists of:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Creating a suitable decimated dipole grid on the white matter surface."}),"\n",(0,t.jsx)(n.li,{children:"Creating the source space file in FIFF format."}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"The following table shows recommended subdivisions for the creation of source spaces. The approximate source spacing and corresponding surface area have been calculated assuming a 1000-cm\xb2 surface area per hemisphere."}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Spacing"}),(0,t.jsx)(n.th,{children:"Sources per hemisphere"}),(0,t.jsx)(n.th,{children:"Source spacing (mm)"}),(0,t.jsx)(n.th,{children:"Surface area per source (mm\xb2)"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"oct5"})}),(0,t.jsx)(n.td,{children:"1026"}),(0,t.jsx)(n.td,{children:"9.9"}),(0,t.jsx)(n.td,{children:"97"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"ico4"})}),(0,t.jsx)(n.td,{children:"2562"}),(0,t.jsx)(n.td,{children:"6.2"}),(0,t.jsx)(n.td,{children:"39"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"oct6"})}),(0,t.jsx)(n.td,{children:"4098"}),(0,t.jsx)(n.td,{children:"4.9"}),(0,t.jsx)(n.td,{children:"24"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"ico5"})}),(0,t.jsx)(n.td,{children:"10242"}),(0,t.jsx)(n.td,{children:"3.1"}),(0,t.jsx)(n.td,{children:"9.8"})]})]})]}),"\n",(0,t.jsx)(n.h3,{id:"creating-the-bem-model-meshes",children:"Creating the BEM Model Meshes"}),"\n",(0,t.jsx)(n.p,{children:"Calculation of the forward solution using the boundary-element model (BEM) requires that the surfaces separating regions of different electrical conductivities are tessellated with suitable surface elements. The MNE BEM software employs triangular tessellations. Prerequisites for BEM calculations are the segmentation of the MRI data and the triangulation of the relevant surfaces."}),"\n",(0,t.jsxs)(n.p,{children:["For ",(0,t.jsx)(n.strong,{children:"MEG computations"}),", a reasonably accurate solution can be obtained by using a single-compartment BEM assuming the shape of the intracranial volume."]}),"\n",(0,t.jsxs)(n.p,{children:["For ",(0,t.jsx)(n.strong,{children:"EEG"}),", the standard model contains the intracranial space, the skull, and the scalp."]}),"\n",(0,t.jsx)(n.p,{children:"Two approaches are available in MNE-CPP:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.a,{href:"tools-watershed-bem",children:"mne_watershed_bem"})})," \u2014 Creates BEM surfaces using FreeSurfer's watershed algorithm"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.a,{href:"tools-flash-bem",children:"mne_flash_bem"})})," \u2014 Creates BEM surfaces using multi-echo FLASH MRI sequences"]}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"head-surface-triangulation-files",children:"Head Surface Triangulation Files"}),"\n",(0,t.jsx)(n.p,{children:"The segmentation algorithms produce either FreeSurfer surfaces or triangulation data in text. Before proceeding to the creation of the boundary element model, the following standard FreeSurfer surface files must be present:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"inner_skull.surf"})," \u2014 Contains the inner skull triangulation"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"outer_skull.surf"})," \u2014 Contains the outer skull triangulation"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"outer_skin.surf"})," \u2014 Contains the head surface triangulation"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"setting-up-the-bem",children:"Setting Up the BEM"}),"\n",(0,t.jsxs)(n.p,{children:["This stage sets up the subject-dependent data for computing the forward solutions using ",(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.a,{href:"tools-setup-forward-model",children:"mne_setup_forward_model"})}),"."]}),"\n",(0,t.jsx)(n.p,{children:"This step assigns the conductivity values to the BEM compartments:"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Compartment"}),(0,t.jsx)(n.th,{children:"Default conductivity (S/m)"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Scalp"}),(0,t.jsx)(n.td,{children:"0.3"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Skull"}),(0,t.jsx)(n.td,{children:"0.006"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Brain"}),(0,t.jsx)(n.td,{children:"0.3"})]})]})]}),"\n",(0,t.jsx)(n.p,{children:"The default skull conductivity ratio is 1:50 relative to scalp/brain. Recent publications report a range of skull conductivity ratios from 1:15 to 1:50. The MNE default ratio 1:50 is based on the typical values reported in the literature, since the approach is based on comparison of SEF/SEP measurements in a BEM model. The variability across publications may depend on individual variations but, more importantly, on the precision of the skull compartment segmentation."}),"\n",(0,t.jsx)(n.admonition,{type:"note",children:(0,t.jsxs)(n.p,{children:["To produce single layer BEM models use the ",(0,t.jsx)(n.code,{children:"--homog"})," flag in ",(0,t.jsx)(n.code,{children:"mne_setup_forward_model"}),". This is suitable for MEG-only analyses."]})}),"\n",(0,t.jsx)(n.p,{children:"After the BEM is set up, it is advisable to check that the BEM model meshes are correctly positioned."}),"\n",(0,t.jsx)(n.admonition,{type:"note",children:(0,t.jsx)(n.p,{children:"Up to this point all processing stages depend on the anatomical (geometrical) information only and thus remain identical across different MEG studies."})}),"\n",(0,t.jsx)(n.h3,{id:"aligning-coordinate-frames",children:"Aligning Coordinate Frames"}),"\n",(0,t.jsxs)(n.p,{children:["The calculation of the forward solution requires knowledge of the relative location and orientation of the MEG/EEG and MRI coordinate systems (see ",(0,t.jsx)(n.a,{href:"forward#megeeg-and-mri-coordinate-systems",children:"The Forward Solution \u2014 Coordinate Systems"}),"). The head coordinate frame is defined by identifying the fiducial landmark locations, making the origin and orientation of the head coordinate system slightly user dependent. As a result, it is safest to reestablish the definition of the coordinate transformation computation for each experimental session, i.e., each time when new head digitization data are employed."]}),"\n",(0,t.jsxs)(n.p,{children:["The coregistration is stored in a ",(0,t.jsx)(n.code,{children:"-trans.fif"})," file."]}),"\n",(0,t.jsx)(n.admonition,{type:"warning",children:(0,t.jsx)(n.p,{children:"This step is important. If the alignment of the coordinate frames is inaccurate, all subsequent processing steps suffer from the error. Therefore, this step should be performed by the person in charge of the study or by a trained technician. Written or photographic documentation of the alignment points employed during the MEG/EEG acquisition can also be helpful."})}),"\n",(0,t.jsx)(n.h3,{id:"computing-the-forward-solution",children:"Computing the Forward Solution"}),"\n",(0,t.jsxs)(n.p,{children:["After the MRI-MEG/EEG alignment has been set, the forward solution \u2014 the magnetic fields and electric potentials at the measurement sensors and electrodes due to dipole sources located on the cortex \u2014 can be calculated using ",(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.a,{href:"tools-forward-solution",children:"mne_forward_solution"})}),"."]}),"\n",(0,t.jsx)(n.h3,{id:"computing-the-noise-covariance-matrix",children:"Computing the Noise-Covariance Matrix"}),"\n",(0,t.jsx)(n.p,{children:"The MNE software employs an estimate of the noise-covariance matrix to weight the channels correctly in the calculations. The noise-covariance matrix provides information about field and potential patterns representing uninteresting noise sources of either human or environmental origin."}),"\n",(0,t.jsxs)(n.p,{children:["The noise covariance matrix can be calculated in several ways using ",(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.a,{href:"tools-process-raw",children:"mne_process_raw"})}),":"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"From epochs"}),": Employ the individual epochs during off-line averaging to calculate the full noise covariance matrix. This is the recommended approach for evoked responses. Use the ",(0,t.jsx)(n.code,{children:"--cov"})," option with a covariance description file."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"From empty room data"}),": Employ empty room data (collected without the subject) to calculate the full noise covariance matrix. This is recommended for analyzing ongoing spontaneous activity."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"From continuous raw data"}),": Employ a section of continuous raw data collected in the presence of the subject. This is the recommended approach for analyzing epileptic activity. The data should be free of technical artifacts and epileptic activity of interest. The length of the data segment should be at least 20 seconds."]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"calculating-the-inverse-operator",children:"Calculating the Inverse Operator"}),"\n",(0,t.jsx)(n.p,{children:"The MNE software doesn't calculate the inverse operator explicitly but rather computes an SVD of a matrix composed of the noise-covariance matrix, the result of the forward calculation, and the source covariance matrix. This approach has the benefit that the regularization parameter (SNR) can be adjusted easily when the final source estimates or dSPMs are computed."}),"\n",(0,t.jsxs)(n.p,{children:["For mathematical details, see ",(0,t.jsx)(n.a,{href:"inverse",children:"The Minimum-Norm Estimates"}),"."]}),"\n",(0,t.jsx)(n.h3,{id:"creating-source-estimates",children:"Creating Source Estimates"}),"\n",(0,t.jsx)(n.p,{children:"Once all the preprocessing steps described above have been completed, the inverse operator can be applied to the MEG and EEG data and the results can be viewed and stored in several ways:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["The interactive analysis tool ",(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.a,{href:"analyze",children:"MNE Analyze"})})," can be used to explore the data and to produce quantitative analysis results, screen snapshots, and movies."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["The command-line tool ",(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.a,{href:"tools-compute-raw-inverse",children:"mne_compute_raw_inverse"})})," can be used to produce files containing source estimates at selected ROIs. The input data file can be either a raw data or evoked response MEG/EEG file."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Source estimates are stored in ",(0,t.jsx)(n.strong,{children:"stc"})," (source time course) and ",(0,t.jsx)(n.strong,{children:"w"})," (snapshot) file formats for subsequent processing, morphing, and visualization."]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"group-analyses",children:"Group Analyses"}),"\n",(0,t.jsxs)(n.p,{children:["Group analysis is facilitated by morphing source estimates to a common template brain (e.g., ",(0,t.jsx)(n.code,{children:"fsaverage"}),"). Subject-to-subject morphing enables cross-subject averaging and comparison of data among subjects. It is also possible to average the source estimates across subjects after morphing to a common surface space."]}),"\n",(0,t.jsx)(n.h2,{id:"references",children:"References"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Esch, L., Dinh, C., Larson, E., Engemann, D., Jas, M., Khan, S., Gramfort, A., & H\xe4m\xe4l\xe4inen, M.S. (2019). MNE: Software for Acquiring, Processing and Visualizing MEG/EEG Data. ",(0,t.jsx)(n.em,{children:"Magnetoencephalography: From Signals to Dynamic Cortical Networks"}),", 2nd Edition. Springer. DOI: ",(0,t.jsx)(n.a,{href:"https://doi.org/10.1007/978-3-319-62657-4_59-1",children:"10.1007/978-3-319-62657-4_59-1"})]}),"\n",(0,t.jsxs)(n.li,{children:["H\xe4m\xe4l\xe4inen, M.S. (2009). ",(0,t.jsx)(n.em,{children:"MNE Software User's Guide"}),". Martinos Center for Biomedical Imaging, Massachusetts General Hospital."]}),"\n",(0,t.jsxs)(n.li,{children:["Gramfort, A., Luessi, M., Larson, E., Engemann, D.A., Strohmeier, D., Brodbeck, C., Goj, R., Jas, M., Brooks, T., Parkkonen, L., & H\xe4m\xe4l\xe4inen, M. (2013). MEG and EEG data analysis with MNE-Python. ",(0,t.jsx)(n.em,{children:"Frontiers in Neuroscience"}),", 7, 267. DOI: ",(0,t.jsx)(n.a,{href:"https://doi.org/10.3389/fnins.2013.00267",children:"10.3389/fnins.2013.00267"})]}),"\n",(0,t.jsxs)(n.li,{children:["Gramfort, A., Luessi, M., Larson, E., Engemann, D.A., Strohmeier, D., Brodbeck, C., Parkkonen, L., & H\xe4m\xe4l\xe4inen, M.S. (2014). MNE software for processing MEG and EEG data. ",(0,t.jsx)(n.em,{children:"NeuroImage"}),", 86, 446\u2013460. DOI: ",(0,t.jsx)(n.a,{href:"https://doi.org/10.1016/j.neuroimage.2013.10.027",children:"10.1016/j.neuroimage.2013.10.027"})]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},28453(e,n,i){i.d(n,{R:()=>a,x:()=>o});var s=i(96540);const t={},r=s.createContext(t);function a(e){const n=s.useContext(r);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:a(e.components),s.createElement(r.Provider,{value:n},e.children)}}}]);