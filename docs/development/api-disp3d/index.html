<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-development/api-disp3d" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">Disp3D (RHI) | MNE-CPP</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://mne-cpp.github.io/img/mne-cpp-social-card.png"><meta data-rh="true" name="twitter:image" content="https://mne-cpp.github.io/img/mne-cpp-social-card.png"><meta data-rh="true" property="og:url" content="https://mne-cpp.github.io/docs/development/api-disp3d"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Disp3D (RHI) | MNE-CPP"><meta data-rh="true" name="description" content="Starting with MNE-CPP v2.0, the 3D visualization library has been rebuilt on top of Qt&#x27;s Rendering Hardware Interface (RHI). The library is now called disp3D_rhi (namespace DISP3DRHILIB). Unlike the previous Qt3D-based implementation, the RHI backend talks directly to the platform&#x27;s native graphics API — Metal on macOS, Vulkan on Linux, Direct3D 11/12 on Windows, or OpenGL as a fallback — giving MNE-CPP a thinner, more portable rendering stack."><meta data-rh="true" property="og:description" content="Starting with MNE-CPP v2.0, the 3D visualization library has been rebuilt on top of Qt&#x27;s Rendering Hardware Interface (RHI). The library is now called disp3D_rhi (namespace DISP3DRHILIB). Unlike the previous Qt3D-based implementation, the RHI backend talks directly to the platform&#x27;s native graphics API — Metal on macOS, Vulkan on Linux, Direct3D 11/12 on Windows, or OpenGL as a fallback — giving MNE-CPP a thinner, more portable rendering stack."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://mne-cpp.github.io/docs/development/api-disp3d"><link data-rh="true" rel="alternate" href="https://mne-cpp.github.io/docs/development/api-disp3d" hreflang="en"><link data-rh="true" rel="alternate" href="https://mne-cpp.github.io/docs/development/api-disp3d" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Library API","item":"https://mne-cpp.github.io/docs/development/api"},{"@type":"ListItem","position":2,"name":"Disp3D (RHI)","item":"https://mne-cpp.github.io/docs/development/api-disp3d"}]}</script><link rel="stylesheet" href="/katex.min.css"><link rel="stylesheet" href="/assets/css/styles.2fde3c3a.css">
<script src="/assets/js/runtime~main.20525045.js" defer="defer"></script>
<script src="/assets/js/main.582b680f.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")),document.documentElement.setAttribute("data-theme-choice",t||"system")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="MNE-CPP Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo-dark.svg" alt="MNE-CPP Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate"></b></a><a class="navbar__item navbar__link" href="/docs/overview">Documentation</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/development/buildguide-cmake">Development</a><a href="https://mne-cpp.github.io/doxygen-api/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">API Reference<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><a class="navbar__item navbar__link" href="/download">Download</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="navbar__item navbar-version-item"><span class="navbar-version-badge">v2.0.0</span></div><a href="https://github.com/mne-tools/mne-cpp" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search searchBarContainer_NW3z" dir="ltr"><input placeholder="Search" aria-label="Search" class="navbar__search-input searchInput_YFbd" value=""><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/development/buildguide-cmake"><span title="Build &amp; Deploy" class="categoryLinkLabel_W154">Build &amp; Deploy</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/docs/development/contribute"><span title="Contributing" class="categoryLinkLabel_W154">Contributing</span></a><button aria-label="Expand sidebar category &#x27;Contributing&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" href="/docs/development/api"><span title="Library API" class="categoryLinkLabel_W154">Library API</span></a><button aria-label="Collapse sidebar category &#x27;Library API&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/development/api-disp3d"><span title="Disp3D (RHI)" class="linkLabel_WmDU">Disp3D (RHI)</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/development/api-connectivity"><span title="Connectivity" class="linkLabel_WmDU">Connectivity</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/development/scan"><span title="Plugin Development" class="categoryLinkLabel_W154">Plugin Development</span></a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/docs/development/api"><span>Library API</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Disp3D (RHI)</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Disp3D — RHI-Based 3D Visualization</h1></header>
<p>Starting with MNE-CPP v2.0, the 3D visualization library has been rebuilt on top of Qt&#x27;s <strong>Rendering Hardware Interface (RHI)</strong>. The library is now called <code>disp3D_rhi</code> (namespace <code>DISP3DRHILIB</code>). Unlike the previous Qt3D-based implementation, the RHI backend talks directly to the platform&#x27;s native graphics API — Metal on macOS, Vulkan on Linux, Direct3D 11/12 on Windows, or OpenGL as a fallback — giving MNE-CPP a thinner, more portable rendering stack.</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Why RHI?</div><div class="admonitionContent_BuS1"><p>Qt3D provided a high-level scene-graph but added significant abstraction overhead. With RHI, the library manages its own render pipeline, vertex buffers, and shader programs directly, resulting in lower latency, smaller binary size, and better control over GPU resource lifetime — all critical for real-time neuroimaging visualization.</p></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="architecture-overview">Architecture Overview<a href="#architecture-overview" class="hash-link" aria-label="Direct link to Architecture Overview" title="Direct link to Architecture Overview" translate="no">​</a></h2>
<p>The library follows a clean separation of concerns inspired by several well-known software patterns:</p>
<ul>
<li class=""><strong>Model–View separation</strong> — The <code>BrainTreeModel</code> (a <code>QStandardItemModel</code>) owns all scene data and metadata. <code>BrainView</code> reads the model to decide <em>what</em> to show; <code>BrainRenderer</code> decides <em>how</em> to draw it. Neither the model nor the renderer know about each other directly — <code>BrainView</code> acts as the mediator.</li>
<li class=""><strong>Retained-mode rendering</strong> — Renderable objects (<code>BrainSurface</code>, <code>DipoleObject</code>, <code>NetworkObject</code>, <code>SourceEstimateOverlay</code>) each own their GPU resources (vertex buffers, index buffers, instance buffers, uniform buffers). They create these resources once on initialization and only update the data that changes per frame (e.g., vertex colors for a new time sample). This avoids per-frame allocation and keeps draw calls cheap.</li>
<li class=""><strong>Strategy pattern for shaders</strong> — The <code>BrainRenderer</code> maintains a set of pre-compiled shader pipelines (<code>Standard</code>, <code>Holographic</code>, <code>Anatomical</code>, <code>Dipole</code>, <code>XRay</code>, <code>ShowNormals</code>). Switching visual style is a pipeline swap, not a recompilation.</li>
<li class=""><strong>Observer / worker pattern</strong> — Real-time data (sensor streams, source estimates) flows through dedicated <code>QObject</code>-based workers running on background threads. Workers emit signals carrying per-vertex color arrays, which <code>BrainView</code> applies to the appropriate renderable before the next draw call. This keeps the render thread free from heavy computation.</li>
<li class=""><strong>Composition over inheritance</strong> — Rather than deep inheritance hierarchies (as in the old Qt3D design where every renderable was a <code>QEntity</code> subclass), the RHI design composes independent objects: a <code>BrainSurface</code> is <em>not</em> a widget or an entity — it is a plain C++ object that knows how to upload geometry and draw itself when asked.</li>
</ul>
<!-- -->
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="key-differences-from-the-qt3d-implementation">Key Differences from the Qt3D Implementation<a href="#key-differences-from-the-qt3d-implementation" class="hash-link" aria-label="Direct link to Key Differences from the Qt3D Implementation" title="Direct link to Key Differences from the Qt3D Implementation" translate="no">​</a></h3>
<table><thead><tr><th>Aspect</th><th>Qt3D (v1.x)</th><th>RHI (v2.0)</th></tr></thead><tbody><tr><td><strong>Widget base</strong></td><td>Custom <code>QWidget</code> + <code>QSurface3DFormat</code></td><td><code>QRhiWidget</code></td></tr><tr><td><strong>Render control</strong></td><td>Qt3D framegraph / scenegraph</td><td>Direct <code>QRhi</code> pipeline + command buffer</td></tr><tr><td><strong>Shader language</strong></td><td>GLSL via Qt3D materials</td><td>GLSL compiled per-backend by Qt RHI</td></tr><tr><td><strong>Data model</strong></td><td><code>Data3DTreeModel</code> + <code>Renderable3DEntity</code> → <code>QEntity</code></td><td><code>BrainTreeModel</code> + <code>BrainSurface</code> / <code>DipoleObject</code> / <code>NetworkObject</code></td></tr><tr><td><strong>Multi-view</strong></td><td>Not built-in</td><td><code>MultiViewLayout</code> with 1–4 panes</td></tr><tr><td><strong>Instanced rendering</strong></td><td><code>GeometryMultiplier</code></td><td>Native QRhi instance buffers</td></tr><tr><td><strong>Vertex picking</strong></td><td>Not implemented</td><td><code>RayPicker</code> with CPU ray–triangle intersection</td></tr><tr><td><strong>Graphics backends</strong></td><td>OpenGL only</td><td>Metal, Vulkan, D3D 11/12, OpenGL</td></tr></tbody></table>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="module-breakdown">Module Breakdown<a href="#module-breakdown" class="hash-link" aria-label="Direct link to Module Breakdown" title="Direct link to Module Breakdown" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="view-layer">View Layer<a href="#view-layer" class="hash-link" aria-label="Direct link to View Layer" title="Direct link to View Layer" translate="no">​</a></h3>
<p>The view layer implements the <strong>Mediator pattern</strong> — <code>BrainView</code> sits between user input, the data model, and the renderer, coordinating their interactions without letting them reference each other directly.</p>
<ul>
<li class=""><strong><code>BrainView</code></strong> — The top-level widget, inheriting from <code>QRhiWidget</code> (Qt&#x27;s portable RHI surface widget). On each frame, Qt calls <code>BrainView::render()</code>, which assembles a <code>SceneData</code> struct containing the current MVP matrix, camera position, light direction, and overlay mode, then hands it to <code>BrainRenderer</code> for drawing. <code>BrainView</code> also handles all mouse/keyboard events and dispatches them to the <code>CameraController</code> (for orbit/zoom/pan) or <code>RayPicker</code> (for vertex selection). It supports two modes: <code>SingleView</code> with an interactive orbiting camera, and <code>MultiView</code> with up to four fixed-angle viewports (e.g., top, left, front, free).</li>
<li class=""><strong><code>MultiViewLayout</code></strong> — A pure-geometry helper with no widget dependencies. It stores fractional split positions and computes viewport rectangles, splitter hit-testing, and minimum pane sizes. <code>BrainView</code> queries this class for the pixel rectangles of each pane before issuing scissored draw calls. The layout supports 1, 2, 3, or 4 panes with draggable separators.</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="render-engine">Render Engine<a href="#render-engine" class="hash-link" aria-label="Direct link to Render Engine" title="Direct link to Render Engine" translate="no">​</a></h3>
<p>The render engine is where the <strong>Strategy pattern</strong> is most visible. <code>BrainRenderer</code> holds a map of pre-compiled <code>QRhiGraphicsPipeline</code> objects — one per <code>ShaderMode</code> — and selects the appropriate pipeline at draw time.</p>
<ul>
<li class=""><strong><code>BrainRenderer</code></strong> — The low-level workhorse. It creates and caches <code>QRhiGraphicsPipeline</code> objects, manages shared uniform buffers (for the scene-wide MVP and lighting data), and iterates over all visible renderables to issue draw calls. Each renderable provides its own vertex/index/instance buffers; <code>BrainRenderer</code> simply binds them and calls <code>drawIndexed()</code> or <code>draw()</code>. The renderer is stateless between frames — all per-frame data arrives via the <code>SceneData</code> struct, making it easy to render the same scene from multiple camera angles (multi-view).</li>
<li class=""><strong>GLSL Shaders</strong> — Six shader programs, each consisting of a <code>.vert</code> and <code>.frag</code> file. Qt&#x27;s RHI layer compiles these at load time into the native shading language of the active backend (Metal Shading Language, SPIR-V for Vulkan, HLSL for D3D, or GLSL for OpenGL). The shaders receive per-vertex attributes (position, normal, packed ABGR color, packed ABGR annotation color) and a uniform block with the scene data. The <code>overlayMode</code> uniform controls which color channel the fragment shader samples — surface, annotation, scientific colormap, or source estimate.</li>
</ul>
<table><thead><tr><th>Shader</th><th>Visual Style</th></tr></thead><tbody><tr><td><code>standard</code></td><td>Phong lighting (default)</td></tr><tr><td><code>holographic</code></td><td>Two-sided holographic effect</td></tr><tr><td><code>anatomical</code></td><td>Curvature-based coloring</td></tr><tr><td><code>dipole</code></td><td>Dipole cone rendering</td></tr><tr><td><code>xray</code></td><td>Semi-transparent x-ray</td></tr><tr><td><code>shownormals</code></td><td>Surface-normal visualization</td></tr></tbody></table>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="renderable-objects">Renderable Objects<a href="#renderable-objects" class="hash-link" aria-label="Direct link to Renderable Objects" title="Direct link to Renderable Objects" translate="no">​</a></h3>
<p>Renderables follow the <strong>Self-Contained Resource</strong> pattern — each object manages the full lifecycle of its GPU resources (creation, update, destruction) and exposes a uniform interface (<code>initResources()</code>, <code>updateResources()</code>, <code>draw()</code>) that <code>BrainRenderer</code> calls. This keeps the renderer agnostic about data types.</p>
<table><thead><tr><th>Class</th><th>Purpose</th><th>GPU Resources</th></tr></thead><tbody><tr><td><code>BrainSurface</code></td><td>Cortical or BEM mesh with per-vertex curvature, annotation, and STC color channels</td><td>Vertex buffer (<code>VertexData</code>: pos, normal, ABGR base, ABGR annotation), index buffer, uniform buffer</td></tr><tr><td><code>DipoleObject</code></td><td>Equivalent current dipoles rendered as instanced cones pointing in the moment direction</td><td>Shared cone geometry + per-instance transform/color buffer</td></tr><tr><td><code>NetworkObject</code></td><td>Connectivity graph — nodes as instanced spheres (diameter ∝ degree), edges as instanced cylinders (diameter and color ∝ weight)</td><td>Shared sphere/cylinder geometry + per-instance transform/color buffers</td></tr><tr><td><code>SourceEstimateOverlay</code></td><td>Per-vertex STC amplitude overlay streamed onto a <code>BrainSurface</code></td><td>Updates the host surface&#x27;s vertex color channel in-place</td></tr></tbody></table>
<p>The <code>VertexData</code> struct deserves special mention. It packs four attributes into a compact interleaved layout:</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">struct</span><span class="token plain"> </span><span class="token class-name">VertexData</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    QVector3D pos</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain">              </span><span class="token comment" style="color:rgb(98, 114, 164)">// vertex position</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    QVector3D norm</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain">             </span><span class="token comment" style="color:rgb(98, 114, 164)">// vertex normal</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">uint32_t</span><span class="token plain">  color</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain">            </span><span class="token comment" style="color:rgb(98, 114, 164)">// curvature / base color   (ABGR packed)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">uint32_t</span><span class="token plain">  colorAnnotation</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)">// annotation region color  (ABGR packed)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><br></span></code></pre></div></div>
<p>Colors are stored as packed <code>uint32_t</code> values (<code>packABGR()</code>) rather than <code>QVector4D</code> floats, halving the per-vertex color footprint — a meaningful saving for high-resolution cortical meshes with 160 000+ vertices.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="data-model">Data Model<a href="#data-model" class="hash-link" aria-label="Direct link to Data Model" title="Direct link to Data Model" translate="no">​</a></h3>
<p>The data model applies the <strong>Composite pattern</strong> via Qt&#x27;s <code>QStandardItemModel</code> tree structure. Every scene object is represented as a tree item; parent items group children logically (subject → hemisphere → surface, or subject → measurement → network). The tree can be displayed in a <code>QTreeView</code> to give users interactive visibility toggles, color pickers, and threshold sliders without any custom widget work.</p>
<p>Crucially, tree items in the RHI design are <strong>not</strong> renderables. In the old Qt3D design, <code>Renderable3DEntity</code> <em>was</em> a <code>QEntity</code> — the data model and the scenegraph were one and the same. In the RHI design, tree items are pure data/metadata containers. <code>BrainView</code> reads the model to decide which <code>BrainSurface</code>, <code>DipoleObject</code>, or <code>NetworkObject</code> instances should be visible, then passes them to <code>BrainRenderer</code>. This separation makes it straightforward to render the same data in multiple viewports with different visibility profiles.</p>
<table><thead><tr><th>Tree Item</th><th>Data Source</th></tr></thead><tbody><tr><td><code>SurfaceTreeItem</code></td><td>FreeSurfer surface + annotation</td></tr><tr><td><code>BemTreeItem</code></td><td>BEM compartment surface</td></tr><tr><td><code>DigitizerTreeItem</code> / <code>DigitizerSetTreeItem</code></td><td>HPI, fiducials, head-shape points</td></tr><tr><td><code>DipoleTreeItem</code></td><td><code>ECDSet</code></td></tr><tr><td><code>NetworkTreeItem</code></td><td><code>Network</code> from the Connectivity library</td></tr><tr><td><code>SourceSpaceTreeItem</code></td><td><code>MNESourceSpace</code></td></tr></tbody></table>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="core">Core<a href="#core" class="hash-link" aria-label="Direct link to Core" title="Direct link to Core" translate="no">​</a></h3>
<p>The core module provides shared types and state that every other module depends on, without pulling in heavy Qt or QRhi headers.</p>
<ul>
<li class=""><strong><code>RenderTypes</code></strong> — A lightweight header-only file defining <code>ShaderMode</code> and <code>VisualizationMode</code> enums and the <code>packABGR()</code> utility. It deliberately avoids any QRhi includes, so public API headers can use these enums without leaking GPU implementation details to downstream consumers.</li>
<li class=""><strong><code>ViewState</code></strong> — Captures all per-viewport settings: camera orientation, lighting parameters, and a <code>ViewVisibilityProfile</code> struct with independent boolean toggles for each data layer (LH, RH, BEM head, BEM outer skull, BEM inner skull, MEG sensors, etc.). Each viewport in a multi-view layout carries its own <code>ViewState</code>, enabling pane-specific views of the same dataset.</li>
<li class=""><strong><code>DataLoader</code></strong> — Centralized utilities for loading FreeSurfer surfaces, annotations, and BEM data into the model and creating the corresponding renderables.</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="input">Input<a href="#input" class="hash-link" aria-label="Direct link to Input" title="Direct link to Input" translate="no">​</a></h3>
<p>Input handling is decoupled from the widget, following the <strong>Strategy pattern</strong> — <code>BrainView</code> delegates input interpretation to specialized objects rather than handling it in monolithic <code>mousePressEvent</code> overrides.</p>
<ul>
<li class=""><strong><code>CameraController</code></strong> — A widget-independent camera that takes mouse delta values and produces a <code>CameraResult</code> struct (projection, view, and model matrices, plus camera position and up vector). It supports orbiting around a focus point, dolly zoom, and panning. Because it has no widget dependency, it can compute matrices for any viewport rectangle, which is how multi-view rendering works — <code>BrainView</code> calls <code>CameraController</code> once per pane with different viewport sizes.</li>
<li class=""><strong><code>RayPicker</code></strong> — Performs CPU-side ray–triangle intersection testing against all visible <code>BrainSurface</code> meshes. Given a mouse position and viewport rectangle, it unprojects a ray and walks the triangle list of each surface to find the closest intersection. The result is a <code>PickResult</code> carrying the hit point, surface key, vertex index, distance, and (if available) the FreeSurfer annotation region name and label ID. Dipole picking is also supported.</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="scene-managers">Scene Managers<a href="#scene-managers" class="hash-link" aria-label="Direct link to Scene Managers" title="Direct link to Scene Managers" translate="no">​</a></h3>
<p>Scene managers encapsulate domain-specific logic that would otherwise bloat <code>BrainView</code>. Each manager owns the lifecycle of its workers and the mapping between raw data and renderable updates.</p>
<ul>
<li class=""><strong><code>SensorFieldMapper</code></strong> — Computes and caches the sparse interpolation matrix that maps sensor-level data (MEG channels or EEG electrodes) onto a scalp or helmet surface mesh. When new samples arrive, it multiplies the data vector by the interpolation matrix to produce per-vertex color values.</li>
<li class=""><strong><code>SourceEstimateManager</code></strong> — Handles loading and streaming of MNE source estimates (STC files or real-time data). It manages the interpolation from source-space vertices to the high-resolution cortical surface mesh and drives the <code>SourceEstimateOverlay</code>.</li>
<li class=""><strong><code>RtSensorStreamManager</code></strong> — Lifecycle manager for <code>RtSensorDataController</code>. It encapsulates the start/stop/configure cycle of real-time sensor streaming, keeping <code>BrainView</code> clean. Internally it manages <code>RtSensorDataWorker</code> and <code>RtSensorInterpolationMatWorker</code> on background threads.</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="background-workers">Background Workers<a href="#background-workers" class="hash-link" aria-label="Direct link to Background Workers" title="Direct link to Background Workers" translate="no">​</a></h3>
<p>Workers implement the <strong>Producer–Consumer pattern</strong> on Qt&#x27;s thread infrastructure. Each worker lives on a dedicated <code>QThread</code> and communicates with the main/render thread via queued signal–slot connections. This guarantees that heavy computation (interpolation matrix construction, per-vertex color mapping) never blocks the render loop.</p>
<table><thead><tr><th>Worker</th><th>Role</th></tr></thead><tbody><tr><td><code>RtSensorDataWorker</code></td><td>Receives raw sensor samples, applies the interpolation matrix, and emits per-vertex color arrays ready for GPU upload</td></tr><tr><td><code>RtSensorInterpolationMatWorker</code></td><td>Builds the sparse interpolation matrix mapping sensor positions to surface vertices (recomputed when sensor geometry changes)</td></tr><tr><td><code>RtSourceDataWorker</code></td><td>Streams source-estimate samples and computes per-vertex STC colors</td></tr><tr><td><code>RtSourceInterpolationMatWorker</code></td><td>Builds the source-space interpolation matrix</td></tr><tr><td><code>StcLoadingWorker</code></td><td>Asynchronous STC file I/O — loads large <code>.stc</code> files without blocking the UI</td></tr></tbody></table>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="usage">Usage<a href="#usage" class="hash-link" aria-label="Direct link to Usage" title="Direct link to Usage" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="quick-start--visualizing-a-brain-surface">Quick Start — Visualizing a Brain Surface<a href="#quick-start--visualizing-a-brain-surface" class="hash-link" aria-label="Direct link to Quick Start — Visualizing a Brain Surface" title="Direct link to Quick Start — Visualizing a Brain Surface" translate="no">​</a></h3>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token macro property directive-hash">#</span><span class="token macro property directive keyword" style="color:rgb(189, 147, 249);font-style:italic">include</span><span class="token macro property"> </span><span class="token macro property string" style="color:rgb(255, 121, 198)">&lt;disp3D_rhi/view/brainview.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token macro property directive-hash">#</span><span class="token macro property directive keyword" style="color:rgb(189, 147, 249);font-style:italic">include</span><span class="token macro property"> </span><span class="token macro property string" style="color:rgb(255, 121, 198)">&lt;disp3D_rhi/model/braintreemodel.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token macro property directive-hash">#</span><span class="token macro property directive keyword" style="color:rgb(189, 147, 249);font-style:italic">include</span><span class="token macro property"> </span><span class="token macro property string" style="color:rgb(255, 121, 198)">&lt;fs/surface.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token macro property directive-hash">#</span><span class="token macro property directive keyword" style="color:rgb(189, 147, 249);font-style:italic">include</span><span class="token macro property"> </span><span class="token macro property string" style="color:rgb(255, 121, 198)">&lt;fs/annotation.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">// Create view and model</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">BrainView </span><span class="token operator">*</span><span class="token plain">view </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">new</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">BrainView</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">BrainTreeModel </span><span class="token operator">*</span><span class="token plain">model </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">new</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">BrainTreeModel</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">view</span><span class="token operator">-&gt;</span><span class="token function" style="color:rgb(80, 250, 123)">setModel</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">model</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">// Load FreeSurfer surfaces</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">FSLIB</span><span class="token double-colon punctuation" style="color:rgb(248, 248, 242)">::</span><span class="token plain">Surface </span><span class="token function" style="color:rgb(80, 250, 123)">surfLh</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;sample&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;inflated&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> subjectsDir</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">FSLIB</span><span class="token double-colon punctuation" style="color:rgb(248, 248, 242)">::</span><span class="token plain">Surface </span><span class="token function" style="color:rgb(80, 250, 123)">surfRh</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;sample&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;inflated&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> subjectsDir</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">model</span><span class="token operator">-&gt;</span><span class="token function" style="color:rgb(80, 250, 123)">addSurface</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;sample&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;lh&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;inflated&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> surfLh</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">model</span><span class="token operator">-&gt;</span><span class="token function" style="color:rgb(80, 250, 123)">addSurface</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;sample&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;rh&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;inflated&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> surfRh</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">// Load annotations</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">FSLIB</span><span class="token double-colon punctuation" style="color:rgb(248, 248, 242)">::</span><span class="token plain">Annotation </span><span class="token function" style="color:rgb(80, 250, 123)">annotLh</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;sample&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;aparc&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> subjectsDir</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">model</span><span class="token operator">-&gt;</span><span class="token function" style="color:rgb(80, 250, 123)">addAnnotation</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;sample&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;lh&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> annotLh</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">view</span><span class="token operator">-&gt;</span><span class="token function" style="color:rgb(80, 250, 123)">show</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="adding-a-connectivity-network">Adding a Connectivity Network<a href="#adding-a-connectivity-network" class="hash-link" aria-label="Direct link to Adding a Connectivity Network" title="Direct link to Adding a Connectivity Network" translate="no">​</a></h3>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token macro property directive-hash">#</span><span class="token macro property directive keyword" style="color:rgb(189, 147, 249);font-style:italic">include</span><span class="token macro property"> </span><span class="token macro property string" style="color:rgb(255, 121, 198)">&lt;disp3D_rhi/model/braintreemodel.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token macro property directive-hash">#</span><span class="token macro property directive keyword" style="color:rgb(189, 147, 249);font-style:italic">include</span><span class="token macro property"> </span><span class="token macro property string" style="color:rgb(255, 121, 198)">&lt;connectivity/network/network.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">// After computing connectivity (see Connectivity library docs)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">QList</span><span class="token operator">&lt;</span><span class="token plain">Network</span><span class="token operator">&gt;</span><span class="token plain"> networks </span><span class="token operator">=</span><span class="token plain"> </span><span class="token class-name">Connectivity</span><span class="token double-colon punctuation" style="color:rgb(248, 248, 242)">::</span><span class="token function" style="color:rgb(80, 250, 123)">calculate</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">settings</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">model</span><span class="token operator">-&gt;</span><span class="token function" style="color:rgb(80, 250, 123)">addNetwork</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">networks</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">first</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;PLI&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="shader-modes-and-visualization-modes">Shader Modes and Visualization Modes<a href="#shader-modes-and-visualization-modes" class="hash-link" aria-label="Direct link to Shader Modes and Visualization Modes" title="Direct link to Shader Modes and Visualization Modes" translate="no">​</a></h2>
<p>The renderer supports multiple shader pipelines (<code>ShaderMode</code>) and surface overlay modes (<code>VisualizationMode</code>):</p>
<table><thead><tr><th>ShaderMode</th><th>Effect</th></tr></thead><tbody><tr><td><code>Standard</code></td><td>Default Phong shading</td></tr><tr><td><code>Holographic</code></td><td>Two-sided holographic effect</td></tr><tr><td><code>Anatomical</code></td><td>Curvature-based coloring</td></tr><tr><td><code>Dipole</code></td><td>Dipole cone rendering</td></tr><tr><td><code>XRay</code></td><td>Semi-transparent x-ray effect</td></tr><tr><td><code>ShowNormals</code></td><td>Surface normals as color</td></tr></tbody></table>
<table><thead><tr><th>VisualizationMode</th><th>Vertex Color Source</th></tr></thead><tbody><tr><td><code>ModeSurface</code></td><td>Curvature-derived gray tones</td></tr><tr><td><code>ModeAnnotation</code></td><td>Atlas / parcellation region colors</td></tr><tr><td><code>ModeScientific</code></td><td>Scientific colormap</td></tr><tr><td><code>ModeSourceEstimate</code></td><td>STC amplitude overlay</td></tr></tbody></table></div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/development/api"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Library API</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/development/api-connectivity"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Connectivity</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#architecture-overview" class="table-of-contents__link toc-highlight">Architecture Overview</a><ul><li><a href="#key-differences-from-the-qt3d-implementation" class="table-of-contents__link toc-highlight">Key Differences from the Qt3D Implementation</a></li></ul></li><li><a href="#module-breakdown" class="table-of-contents__link toc-highlight">Module Breakdown</a><ul><li><a href="#view-layer" class="table-of-contents__link toc-highlight">View Layer</a></li><li><a href="#render-engine" class="table-of-contents__link toc-highlight">Render Engine</a></li><li><a href="#renderable-objects" class="table-of-contents__link toc-highlight">Renderable Objects</a></li><li><a href="#data-model" class="table-of-contents__link toc-highlight">Data Model</a></li><li><a href="#core" class="table-of-contents__link toc-highlight">Core</a></li><li><a href="#input" class="table-of-contents__link toc-highlight">Input</a></li><li><a href="#scene-managers" class="table-of-contents__link toc-highlight">Scene Managers</a></li><li><a href="#background-workers" class="table-of-contents__link toc-highlight">Background Workers</a></li></ul></li><li><a href="#usage" class="table-of-contents__link toc-highlight">Usage</a><ul><li><a href="#quick-start--visualizing-a-brain-surface" class="table-of-contents__link toc-highlight">Quick Start — Visualizing a Brain Surface</a></li><li><a href="#adding-a-connectivity-network" class="table-of-contents__link toc-highlight">Adding a Connectivity Network</a></li></ul></li><li><a href="#shader-modes-and-visualization-modes" class="table-of-contents__link toc-highlight">Shader Modes and Visualization Modes</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Documentation</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/overview">Getting Started</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/manual/intro">Manual</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/publications">Publications</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Development</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/development/buildguide-cmake">Build from Source</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/development/contribute">Contribute</a></li><li class="footer__item"><a href="https://mne-cpp.github.io/doxygen-api/" target="_blank" rel="noopener noreferrer" class="footer__link-item">API Reference<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/mne-tools/mne-cpp" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/docs/cite">How to Cite</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/overview#legal-notice">Legal Notice</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2026 MNE-CPP. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>